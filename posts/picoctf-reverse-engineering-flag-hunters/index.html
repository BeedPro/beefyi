
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>picoCTF - Reverse Engineering | Flag Hunters</title>
		<meta name="description" content="A writeup of picoCTF&#39;s Reeverse Engineering Flag Hunters Challenge">
		<link rel="alternate" href="/beefyi/feed/feed.xml" type="application/atom+xml" title="beefyi">
		<link rel="icon" href="/beefyi/favicon/favicon.ico" sizes="any">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace:
		Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console,
		Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono,
		Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #bac2de;
	--color-gray-90: #cdd6f4;

	--background-color: #11111b;

	--text-color: var(--color-gray-90);
	--text-color-link: #b4befe;
	--text-color-link-active: #89b4fa;
	--text-color-link-visited: #cba6f7;

	--syntax-tab-size: 2;
}

:root {
	--ctp-surface: #1e1e2e;

	--ctp-note: #89b4fa; /* Blue */
	--ctp-tip: #a6e3a1; /* Green */
	--ctp-important: #f38ba8; /* Red */
	--ctp-warning: #f9e2af; /* Yellow */
	--ctp-caution: #fab387; /* Peach */
}

/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img {
	max-width: 100%;
}
img[width][height] {
	height: auto;
}
img[src$=".svg"] {
	width: 100%;
	height: auto;
	max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
main :first-child {
	margin-top: 0;
}

header {
	border-bottom: 1px solid var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: 0.5em 1em;
	list-style: "";
	border-top: 1px solid var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
}
pre {
	border: 4px solid var(--text-color-link-active);
	padding: 16px;
}
pre:not([class*="language-"]) {
	margin: 0.5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: 0.5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
	padding-left: 1.5rem;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	content: "" counter(start-from, decimal-leading-zero) ". ";
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	padding-left: 0.25em;
	padding-right: 0.5em;
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	text-transform: lower;
	font-style: italic;
	text-decoration: none;
}
.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: 0.5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-left: auto;
}

/* Base Alert Style */
.markdown-alert {
	padding: 1rem;
	margin: 1.5rem 0;
	border-left: 4px solid;
	border-radius: 6px;
	background-color: var(--ctp-surface);
	color: var(--text-color);
	font-size: 0.95rem;
	line-height: 1.5;
}

.markdown-alert p {
	margin: 0;
}

/* Title styling */
.markdown-alert-title {
	font-weight: bold;
	margin-bottom: 0.5rem;
	color: inherit;
	text-transform: uppercase;
	letter-spacing: 0.03em;
}

/* Variants using Catppuccin variables */

.markdown-alert-note {
	border-left-color: var(--ctp-note);
}

.markdown-alert-tip {
	border-left-color: var(--ctp-tip);
}

.markdown-alert-important {
	border-left-color: var(--ctp-important);
}

.markdown-alert-warning {
	border-left-color: var(--ctp-warning);
}

.markdown-alert-caution {
	border-left-color: var(--ctp-caution);
}

/* Colour-specific titles matching the border */
.markdown-alert-note .markdown-alert-title {
	color: var(--ctp-note);
}

.markdown-alert-tip .markdown-alert-title {
	color: var(--ctp-tip);
}

.markdown-alert-important .markdown-alert-title {
	color: var(--ctp-important);
}

.markdown-alert-warning .markdown-alert-title {
	color: var(--ctp-warning);
}

.markdown-alert-caution .markdown-alert-title {
	color: var(--ctp-caution);
}
/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}</style>
		
	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/beefyi/" class="home-link">beefyi</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/beefyi/posts/">Posts</a></li>
					<li class="nav-item"><a href="/beefyi/tags/">Tags</a></li>
					<li class="nav-item"><a href="/beefyi/about/">About</a></li>
					<li class="nav-item"><a href="/beefyi/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<link href="https://prismjs.catppuccin.com/mocha.css" rel="stylesheet">
<h1 id="picoctf-reverse-engineering-flag-hunters">picoCTF - Reverse Engineering | Flag Hunters</h1>

<ul class="post-metadata">
	<li><time datetime="2025-08-31">31 August 2025</time></li>
	<li><a href="/beefyi/tags/ctf/" class="post-tag">ctf</a>, </li>
	<li><a href="/beefyi/tags/writeup/" class="post-tag">writeup</a>, </li>
	<li><a href="/beefyi/tags/reverse-engineering/" class="post-tag">reverse-engineering</a></li>
</ul>

<p><a href="https://play.picoctf.org/practice/challenge/472?category=3&amp;difficulty=1&amp;page=1">Flag Hunters</a> is a reverse engineering challenge. The idea with these is straightforward: figure out what the program is doing, then twist that to your advantage. In this case, though, we're given the source code – so it feels less like breaking into a black box and more like an coding dry-run exercise. The code's written in Python, and our mission is to print out the flag that the program does not show us.</p>
<h2 id="source-code">Source code</h2>
<pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> re
<span class="token keyword">import</span> time


<span class="token comment"># Read in flag from file</span>
flag <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

secret_intro <span class="token operator">=</span> \
<span class="token triple-quoted-string string">'''Pico warriors rising, puzzles laid bare,
Solving each challenge with precision and flair.
With unity and skill, flags we deliver,
The ether’s ours to conquer, '''</span>\
<span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token string">'\n'</span>


song_flag_hunters <span class="token operator">=</span> secret_intro <span class="token operator">+</span>\
<span class="token triple-quoted-string string">'''

[REFRAIN]
We’re flag hunters in the ether, lighting up the grid,
No puzzle too dark, no challenge too hid.
With every exploit we trigger, every byte we decrypt,
We’re chasing that victory, and we’ll never quit.
CROWD (Singalong here!);
RETURN

[VERSE1]
Command line wizards, we’re starting it right,
Spawning shells in the terminal, hacking all night.
Scripts and searches, grep through the void,
Every keystroke, we're a cypher's envoy.
Brute force the lock or craft that regex,
Flag on the horizon, what challenge is next?

REFRAIN;

Echoes in memory, packets in trace,
Digging through the remnants to uncover with haste.
Hex and headers, carving out clues,
Resurrect the hidden, it's forensics we choose.
Disk dumps and packet dumps, follow the trail,
Buried deep in the noise, but we will prevail.

REFRAIN;

Binary sorcerers, let’s tear it apart,
Disassemble the code to reveal the dark heart.
From opcode to logic, tracing each line,
Emulate and break it, this key will be mine.
Debugging the maze, and I see through the deceit,
Patch it up right, and watch the lock release.

REFRAIN;

Ciphertext tumbling, breaking the spin,
Feistel or AES, we’re destined to win.
Frequency, padding, primes on the run,
Vigenère, RSA, cracking them for fun.
Shift the letters, matrices fall,
Decrypt that flag and hear the ether call.

REFRAIN;

SQL injection, XSS flow,
Map the backend out, let the database show.
Inspecting each cookie, fiddler in the fight,
Capturing requests, push the payload just right.
HTML's secrets, backdoors unlocked,
In the world wide labyrinth, we’re never lost.

REFRAIN;

Stack's overflowing, breaking the chain,
ROP gadget wizardry, ride it to fame.
Heap spray in silence, memory's plight,
Race the condition, crash it just right.
Shellcode ready, smashing the frame,
Control the instruction, flags call my name.

REFRAIN;

END;
'''</span>

MAX_LINES <span class="token operator">=</span> <span class="token number">100</span>

<span class="token keyword">def</span> <span class="token function">reader</span><span class="token punctuation">(</span>song<span class="token punctuation">,</span> startLabel<span class="token punctuation">)</span><span class="token punctuation">:</span>
  lip <span class="token operator">=</span> <span class="token number">0</span>
  start <span class="token operator">=</span> <span class="token number">0</span>
  refrain <span class="token operator">=</span> <span class="token number">0</span>
  refrain_return <span class="token operator">=</span> <span class="token number">0</span>
  finished <span class="token operator">=</span> <span class="token boolean">False</span>

  <span class="token comment"># Get list of lyric lines</span>
  song_lines <span class="token operator">=</span> song<span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment"># Find startLabel, refrain and refrain return</span>
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>song_lines<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> song_lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> startLabel<span class="token punctuation">:</span>
      start <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">elif</span> song_lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'[REFRAIN]'</span><span class="token punctuation">:</span>
      refrain <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">elif</span> song_lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'RETURN'</span><span class="token punctuation">:</span>
      refrain_return <span class="token operator">=</span> i

  <span class="token comment"># Print lyrics</span>
  line_count <span class="token operator">=</span> <span class="token number">0</span>
  lip <span class="token operator">=</span> start
  <span class="token keyword">while</span> <span class="token keyword">not</span> finished <span class="token keyword">and</span> line_count <span class="token operator">&lt;</span> MAX_LINES<span class="token punctuation">:</span>
    line_count <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> song_lines<span class="token punctuation">[</span>lip<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">if</span> line <span class="token operator">==</span> <span class="token string">''</span> <span class="token keyword">and</span> song_lines<span class="token punctuation">[</span>lip<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
      <span class="token keyword">if</span> line <span class="token operator">==</span> <span class="token string">'REFRAIN'</span><span class="token punctuation">:</span>
        song_lines<span class="token punctuation">[</span>refrain_return<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'RETURN '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lip <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        lip <span class="token operator">=</span> refrain
      <span class="token keyword">elif</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">r"CROWD.*"</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>
        crowd <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Crowd: '</span><span class="token punctuation">)</span>
        song_lines<span class="token punctuation">[</span>lip<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Crowd: '</span> <span class="token operator">+</span> crowd
        lip <span class="token operator">+=</span> <span class="token number">1</span>
      <span class="token keyword">elif</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">r"RETURN [0-9]+"</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>
        lip <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">elif</span> line <span class="token operator">==</span> <span class="token string">'END'</span><span class="token punctuation">:</span>
        finished <span class="token operator">=</span> <span class="token boolean">True</span>
      <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        lip <span class="token operator">+=</span> <span class="token number">1</span>



reader<span class="token punctuation">(</span>song_flag_hunters<span class="token punctuation">,</span> <span class="token string">'[VERSE1]'</span><span class="token punctuation">)</span></code></pre>
<p>Looking through the code, it's clear that the <code>secret_intro</code> is hiding the flag right at the start of the song. The catch? The lyric reader doesn’t begin there – it starts off at <code>[VERSE1]</code>. That means we never actually see the intro unless we mess with the program flow. The program moves between sections using the keywords <code>[REFRAIN]</code> and <code>RETURN</code>, so the trick is to sneak one of those into the lyrics and force the reader to jump back up to the very first line. There are 3 key areas of the code that allow us to inject our own code and make it read out the start of the song.</p>
<p>First up, the splitting:</p>
<pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">for</span> line <span class="token keyword">in</span> song_lines<span class="token punctuation">[</span>lip<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">:</span></code></pre>
<p>This means every line is chopped up at <code>;</code>, so you can sneak in multiple 'mini-lines' by separating them with semicolons.</p>
<p>Then, the user input with no checks:</p>
<pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">elif</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">r"CROWD.*"</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>
    crowd <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Crowd: '</span><span class="token punctuation">)</span>
    song_lines<span class="token punctuation">[</span>lip<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Crowd: '</span> <span class="token operator">+</span> crowd
    lip <span class="token operator">+=</span> <span class="token number">1</span></code></pre>
<p>See the problem? Whatever you type into <code>Crowd:</code> gets dumped straight back into the song. No filtering, no sanitisation – just raw text being executed by the program. Perfert to inject into.</p>
<p>And finally, the <code>RETURN</code> command:</p>
<pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">elif</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">r"RETURN [0-9]+"</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lip <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>
<p>If the program sees <code>RETURN &lt;number&gt;</code>, it jumps directly to that line number in the song. Combine this with the input above, and we can plant something like <code>RETURN 0</code> into the lyrics and force the program to loop back to the start – right where the flag is sitting in <code>secret_intro</code>.</p>
<h2 id="solution">Solution</h2>
<p>The solution is to use the <code>Crowd:</code> input as our injection point. If we start our input with a <code>;</code>, the program treats everything after it as a brand-new line. That means we can slip in our own <code>RETURN</code> statement.</p>
<p>So, something like this works perfectly:</p>
<pre><code>;RETURN 0
</code></pre>
<p>What happens is neat: after the jump, the program sees an empty <code>Crowd:</code> field (so nothing breaks), and then sees <code>RETURN 0</code> due to the split and immediately loops back to the top of the song. And since the <code>secret_intro</code> is sitting right there, it starts reading out the flag for us!</p>
<pre><code>Crowd: ;RETURN 0

Echoes in memory, packets in trace,
Digging through the remnants to uncover with haste.
Hex and headers, carving out clues,
Resurrect the hidden, it's forensics we choose.
Disk dumps and packet dumps, follow the trail,
Buried deep in the noise, but we will prevail.

We’re flag hunters in the ether, lighting up the grid,
No puzzle too dark, no challenge too hid.
With every exploit we trigger, every byte we decrypt,
We’re chasing that victory, and we’ll never quit.
Crowd:
Pico warriors rising, puzzles laid bare,
Solving each challenge with precision and flair.
With unity and skill, flags we deliver,
The ether’s ours to conquer, picoCTF{70637h3r_f0r3v3r_c373964d}
</code></pre>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/beefyi/posts/picoctf-cryptography-even-rsa-can-be-broken/">picoCTF - Cryptography | EVEN RSA CAN BE BROKEN???</a></li>
</ul>

			</heading-anchors>
		</main>

		<footer>
			<p>
				<em>Built with <a href="https://www.11ty.dev/">Eleventy v3.1.2</a></em>
			</p>
		</footer>

		<!-- This page `/posts/picoctf-reverse-engineering-flag-hunters/` was built on 2025-08-31T13:11:00.617Z -->
		<script type="module" src="/beefyi/dist/xbxy_EL6cU.js"></script>
	</body>
</html>
